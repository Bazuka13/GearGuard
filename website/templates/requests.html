{% extends 'base.html' %}
{% block content %}
<div class="fade-in">
    <div class="flex justify-between items-center mb-5">
        <h2 class="text-xl font-bold text-white">Requests</h2>
        <div class="flex items-center gap-3">
             <form action="{{ url_for('maintenance_requests') }}" method="GET">
                <input type="text" name="q" placeholder="Search machine..." class="bg-slate-900 border border-slate-700 rounded-md px-4 py-1.5 text-xs text-white">
             </form>
             <button onclick="document.getElementById('createModal').classList.remove('hidden')" class="bg-violet-600 text-white px-3 py-1.5 rounded-md text-xs">
                <i class="fas fa-plus"></i> New
            </button>
        </div>
    </div>

    <div class="bg-slate-900/50 border border-slate-800 rounded-lg overflow-hidden">
        <table class="w-full text-left text-xs text-slate-300">
            <thead class="bg-slate-900/50 text-slate-500 border-b border-slate-800 uppercase">
                <tr>
                    <th class="px-4 py-3">ID</th>
                    <th class="px-4 py-3">Description</th>
                    <th class="px-4 py-3">Equipment</th>
                    <th class="px-4 py-3">Status</th>
                    <th class="px-4 py-3">Technician</th>
                    <th class="px-4 py-3">Created By</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-slate-800">
                {% for req in requests %}
                <tr class="hover:bg-slate-800/40">
                    <td class="px-4 py-3 text-violet-400">#{{ req.id }}</td>
                    <td class="px-4 py-3 font-medium text-white">{{ req.description }}</td>
                    <td class="px-4 py-3">{{ req.equipment.name }}</td>
                    <td class="px-4 py-3">
                        <span class="px-2 py-0.5 rounded bg-slate-700 text-slate-300">{{ req.status }}</span>
                    </td>
                    <td class="px-4 py-3">{{ req.technician.name if req.technician else 'Unassigned' }}</td>
                    <td class="px-4 py-3">{{ req.created_by_user.name }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div id="createModal" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm">
        <div class="bg-[#0f172a] rounded-lg border border-slate-700 w-full max-w-md p-6">
            <h3 class="text-white font-bold mb-4">New Request</h3>
            <form action="{{ url_for('create_request') }}" method="POST" class="space-y-4">
                <div>
                    <label class="text-xs text-slate-400 block mb-1">Description</label>
                    <input type="text" name="subject" required class="w-full bg-slate-800 border border-slate-700 rounded px-3 py-2 text-white text-xs">
                </div>
                <div>
                    <label class="text-xs text-slate-400 block mb-1">Equipment</label>
                    <select name="equipment_id" class="w-full bg-slate-800 border border-slate-700 rounded px-3 py-2 text-white text-xs">
                        {% for eq in equipments %}
                        <option value="{{ eq.id }}">{{ eq.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div>
                    <label class="text-xs text-slate-400 block mb-1">Duration (Hrs)</label>
                    <input type="number" name="duration" class="w-full bg-slate-800 border border-slate-700 rounded px-3 py-2 text-white text-xs">
                </div>
                <div class="flex justify-end gap-2 pt-2">
                    <button type="button" onclick="document.getElementById('createModal').classList.add('hidden')" class="px-3 py-1.5 text-xs text-slate-300 border border-slate-700 rounded">Cancel</button>
                    <button type="submit" class="px-3 py-1.5 text-xs bg-violet-600 text-white rounded">Submit</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}
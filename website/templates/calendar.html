{% extends "layout.html" %}

{% block content %}
<style>
    :root {
        --neon-cyan: #00d2ff;
        --neon-green: #00ff88;
        --glass-bg: rgba(255, 255, 255, 0.03);
    }

    h2 {
        font-family: 'Orbitron', sans-serif !important;
        color: var(--neon-cyan);
        letter-spacing: 5px;
        text-shadow: 0 0 15px rgba(0, 210, 255, 0.4);
    }

    /* Search Interface */
    .search-hud {
        background: rgba(0, 0, 0, 0.4);
        border: 1px solid rgba(0, 210, 255, 0.3);
        border-radius: 8px;
        color: white;
        padding: 8px 15px;
        font-family: 'Inter', sans-serif;
        width: 250px;
        transition: 0.3s;
        font-size: 0.8rem;
    }
    .search-hud:focus {
        outline: none;
        border-color: var(--neon-cyan);
        box-shadow: 0 0 15px rgba(0, 210, 255, 0.2);
    }

    /* Modal Styling */
    .modal-content {
        background: rgba(10, 14, 20, 0.98);
        backdrop-filter: blur(20px);
        border: 1px solid var(--neon-cyan);
        border-radius: 20px;
        color: white;
    }

    /* Tactical Card Design */
    .mission-card {
        background: var(--glass-bg);
        backdrop-filter: blur(15px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 15px;
        padding: 20px;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        transition: 0.4s;
        border-left: 4px solid var(--neon-cyan);
    }

    .mission-card:hover {
        transform: translateX(10px);
        border-color: var(--neon-green);
    }

    .date-box {
        min-width: 100px;
        text-align: center;
        border-right: 1px solid rgba(255, 255, 255, 0.1);
        margin-right: 25px;
    }

    .date-day { font-family: 'Orbitron', sans-serif; font-size: 1.5rem; font-weight: bold; display: block; }
    .date-month { font-size: 0.7rem; text-transform: uppercase; letter-spacing: 2px; color: #94a3b8; }

    .tech-tag {
        font-size: 0.65rem;
        background: rgba(0, 210, 255, 0.1);
        color: var(--neon-cyan);
        padding: 2px 10px;
        border-radius: 5px;
        border: 1px solid var(--neon-cyan);
    }

    .status-indicator { margin-left: auto; text-align: right; }
    .glow-dot { height: 10px; width: 10px; background-color: var(--neon-green); border-radius: 50%; display: inline-block; box-shadow: 0 0 10px var(--neon-green); margin-right: 10px; }
</style>

<div class="schedule-container mt-5">
    <div class="d-flex justify-content-between align-items-center mb-5">
        <div>
            <h2>OPERATIONAL_SCHEDULE</h2>
            <p class="text-secondary small mb-0" style="letter-spacing: 2px;">PREVENTIVE_MAINTENANCE_LOG</p>
        </div>
        
        <div class="d-flex gap-3">
            <input type="text" id="scheduleSearch" class="search-hud" placeholder="FILTER_BY_ASSET...">
            <button class="btn btn-outline-info btn-sm" data-bs-toggle="modal" data-bs-target="#addEntryModal" style="font-family:'Orbitron';">
                [ ADD_ENTRY ]
            </button>
        </div>
    </div>

    <div id="missionList">
        {% for event in events %}
        <div class="mission-card shadow-lg" data-asset="{{ event.asset|lower }}">
            <div class="date-box">
                <span class="date-month">{{ event.date.split('-')[1] }}</span>
                <span class="date-day">{{ event.date.split('-')[2] }}</span>
                <span class="date-month">{{ event.date.split('-')[0] }}</span>
            </div>
            
            <div class="mission-details">
                <h6 style="font-family:'Orbitron';">{{ event.task }}</h6>
                <p class="small text-muted mb-2">ASSET_ID: {{ event.asset }}</p>
                <span class="tech-tag">TECH: {{ event.tech }}</span>
            </div>

            <div class="status-indicator">
                <span class="glow-dot"></span>
                <span class="small fw-bold text-uppercase" style="font-size: 0.7rem;">{{ event.urgency }}</span>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<div class="modal fade" id="addEntryModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content p-3">
            <div class="modal-header border-0">
                <h5 class="modal-title">INITIALIZE_MISSION</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <form action="/calendar/add" method="POST">
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label small text-secondary">TASK_NAME</label>
                        <input type="text" name="task" class="form-control bg-dark text-white border-secondary" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label small text-secondary">TARGET_ASSET</label>
                        <input type="text" name="asset" class="form-control bg-dark text-white border-secondary" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label small text-secondary">DATE</label>
                        <input type="date" name="date" class="form-control bg-dark text-white border-secondary" required>
                    </div>
                </div>
                <div class="modal-footer border-0">
                    <button type="submit" class="btn btn-info w-100 fw-bold" onclick="showToast()">COMMIT_TO_SCHEDULE</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    document.getElementById('scheduleSearch').addEventListener('input', function(e) {
        let filter = e.target.value.toLowerCase();
        let cards = document.querySelectorAll('.mission-card');
        cards.forEach(card => {
            let asset = card.getAttribute('data-asset');
            card.style.display = asset.includes(filter) ? 'flex' : 'none';
        });
    });
</script>
{% endblock %}